#!/bin/sh -x

dev_tools_dir=`xcode-select -print-path`

osascript -e 'tell application "iPhone Simulator" to quit'

sleep 1

if `echo $1 | grep -q "("`;then
    defaults write com.apple.iphonesimulator SimulateDevice "'$1'"
else
    defaults write com.apple.iphonesimulator SimulateDevice "$1"
fi

$dev_tools_dir/Platforms/iPhoneSimulator.platform/Developer/Applications/iPhone\ Simulator.app/Contents/MacOS/iPhone\ Simulator &

sleep 1

osascript -e 'tell application "iPhone Simulator" to activate'